(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{"./app/src/components/FreeTrial/FreeTrialBanner.less":function(e,n,a){var t=a("./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./app/src/components/FreeTrial/FreeTrialBanner.less");"string"==typeof t&&(t=[[e.i,t,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};a("./node_modules/style-loader/lib/addStyles.js")(t,r);t.locals&&(e.exports=t.locals)},"./app/src/components/FreeTrial/index.ts":function(e,n,a){"use strict";a.r(n),a.d(n,"UpsellOverlay",(function(){return t.a})),a.d(n,"FreeTrialBanner",(function(){return M})),a.d(n,"PlanSelectionType",(function(){return y.PlanSelectionType})),a.d(n,"PlanSelectionOverlay",(function(){return y.PlanSelectionOverlay})),a.d(n,"useFreeTrialEligibilityRules",(function(){return _.a}));var t=a("./app/src/components/FreeTrial/UpsellOverlay.tsx"),r=a("./node_modules/react/index.js"),o=a.n(r),i=a("./node_modules/classnames/index.js"),s=a.n(i),l=a("./packages/config/index.ts"),c=a("./packages/nachos/index.ts"),u=a("./node_modules/js-cookie/src/js.cookie.js"),d=a.n(u),m=a("./app/common/components/controls/icon/index.tsx"),p=a("./packages/dates/index.ts"),f=a("./app/common/lib/util/i18n/index.ts"),g=a("./packages/graphql/generated.tsx"),b=a("./app/src/components/FreeTrial/FreeTrialBanner.less"),v=a.n(b),y=a("./app/src/components/FreeTrial/PlanSelection.tsx"),x=a("./packages/atlassian-analytics/index.ts"),_=a("./app/src/components/FreeTrial/useFreeTrialEligibilityRules.ts"),j=a("./node_modules/canvas-confetti/dist/confetti.module.mjs"),h=a("./node_modules/underscore/underscore.js"),T=a.n(h),w=a("./app/src/components/ErrorBoundary/ErrorBoundary.tsx"),E=a("./app/scripts/debug/constants.ts"),k=a("./packages/webdriverio-tests/index.ts");function N(e,n,a,t,r,o,i){try{var s=e[o](i),l=s.value}catch(e){return void a(e)}s.done?n(l):Promise.resolve(l).then(t,r)}function B(e){return function(){var n=this,a=arguments;return new Promise((function(t,r){var o=e.apply(n,a);function i(e){N(o,t,r,i,s,"next",e)}function s(e){N(o,t,r,i,s,"throw",e)}i(void 0)}))}}function C(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],t=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done)&&(a.push(i.value),!n||a.length!==n);t=!0);}catch(e){r=!0,o=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw o}}return a}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return F(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return F(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,n){(null==n||n>e.length)&&(n=e.length);for(var a=0,t=new Array(n);a<n;a++)t[a]=e[a];return t}var O=Object(f.forNamespace)("free trial existing"),M=function(e){var n,a,t,i,u,b,h,N=e.orgId,F=C(Object(r.useState)(!1),2),M=F[0],S=F[1],A=function(){return S(!0)},I="free-trial-banner-".concat(N),P="free-trial-banner-confetti-".concat(N),R=C(Object(g.qb)(),1)[0],z=Object(_.a)(N),G=z.isTrialActive,X=z.freeTrialCredit,q=z.isAdmin,D=Object(g.pb)({variables:{orgId:N}}),U=D.data,V=D.loading,H=(null==U||null===(n=U.member)||void 0===n?void 0:n.oneTimeMessagesDismissed)?null==U||null===(a=U.member)||void 0===a?void 0:a.oneTimeMessagesDismissed:[],Z=C(Object(r.useState)(0),2),L=Z[0],W=Z[1],J=C(Object(r.useState)(0),2),Q=J[0],Y=J[1],$=Object(r.useCallback)((function(){R({variables:{memberId:"me",messageId:P},optimisticResponse:{__typename:"Mutation",addOneTimeMessagesDismissed:{id:"me",oneTimeMessagesDismissed:H.concat([P]),__typename:"Member"}}})}),[H,R,P]),K=H.includes(P);Object(r.useEffect)((function(){L&&Q&&!V&&!K&&(Object(j.default)({angle:T.a.random(0,45),spread:T.a.random(150,180),particleCount:150,origin:{x:0,y:Q/window.innerHeight}}),$())}),[L,Q,V,K,$]);var ee=Object(r.useCallback)((function(e){if(null!==e){var n=e.getBoundingClientRect();W(n.x+n.width/2),Y(n.y+n.height/2)}K&&j.default.reset()}),[K]),ne=null==U||null===(t=U.organization)||void 0===t?void 0:t.displayName,ae=null==U||null===(i=U.organization)||void 0===i?void 0:i.url,te=null==U||null===(u=U.organization)||void 0===u||null===(b=u.paidAccount)||void 0===b?void 0:b.canRenew;if(!X||H.includes(I)||V||(null==U||null===(h=U.organization)||void 0===h?void 0:h.idEnterprise)||l.dontUpsell)return null;var re=Object(p.c)(X.id),oe=X.count,ie=re.setDate(re.getDate()+oe),se=ie&&Object(p.a)(new Date,new Date(ie),!0),le=Math.ceil(se),ce=d.a.get("simulateExpiredTrial"),ue=G&&!ce,de=30===(null==X?void 0:X.count),me=function(){var e=B(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=q&&ue?"admin":ue?"normal":"expired",x.Analytics.sendViewedBannerEvent({bannerName:"freeTrialBanner",source:Object(x.getScreenFromUrl)(),containers:{organization:{id:N}},attributes:{type:n}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=s()(v.a.container,ue?v.a.bannerBg:v.a.expiredBg),fe=function(){var e=B(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x.Analytics.sendDismissedComponentEvent({componentType:"banner",componentName:"freeTrialBanner",source:Object(x.getScreenFromUrl)(),containers:{organization:{id:N}}}),R({variables:{memberId:"me",messageId:I},optimisticResponse:{__typename:"Mutation",addOneTimeMessagesDismissed:{id:"me",oneTimeMessagesDismissed:H.concat([I]),__typename:"Member"}}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ge=function(){if(ae){var e="".concat(ae,"/billing"),n=q&&ue?"addPaymentButton":"upgradeButton";x.Analytics.sendClickedButtonEvent({buttonName:n,source:"freeTrialBanner",containers:{organization:{id:N}}}),window.location.assign(e)}};if(!q&&!ue||q&&de)return null;me();return o.a.createElement(w.a,{tags:{ownershipArea:"trello-bizteam",feature:E.Feature.FreeTrialExistingTeam}},o.a.createElement("div",{className:pe},o.a.createElement("div",{className:v.a.bcContainer},ue?o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{role:"img","aria-label":"confetti",className:v.a.emoji},"ðŸŽ‰"),Object(f.localizeCount)("free-trial-banner-tagline-by-days",le,{teamName:o.a.createElement(o.a.Fragment,{key:ne},ne),days:o.a.createElement("div",{ref:ee,key:"".concat(ne,"-").concat(le),className:v.a.daysContainer},le)})):o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{role:"img","aria-label":"wave",className:v.a.emoji},"ðŸ‘‹"),O(["banner","expired tagline"],{teamName:o.a.createElement(o.a.Fragment,{key:ne},ne)}))),o.a.createElement("div",{className:v.a.ctaContainer},ue?o.a.createElement(o.a.Fragment,null,q&&!te?o.a.createElement(o.a.Fragment,null,o.a.createElement("a",{role:"button",className:v.a.learnMoreCta,onClick:function(){x.Analytics.sendClickedLinkEvent({linkName:"learnMoreLink",source:"freeTrialBanner",containers:{organization:{id:N}}}),A()}},Object(f.forNamespace)("learn more button")("")),o.a.createElement(c.Button,{className:v.a.button,appearance:"primary",onClick:ge,"data-test-id":k.FreeTrialTestIds.BannerAddPaymentButton},O(["banner","add-payment-method"]))):o.a.createElement(o.a.Fragment,null,o.a.createElement(c.Button,{className:v.a.button,appearance:"primary",onClick:function(){x.Analytics.sendClickedButtonEvent({buttonName:"learnMoreButton",source:"freeTrialBanner",containers:{organization:{id:N}}}),A()}},Object(f.forNamespace)("learn more button")("")),o.a.createElement("button",{className:v.a.closeButton,onClick:fe},o.a.createElement(m.default,{className:v.a.closeIcon,name:m.IconName.Close,medium:!0})))):o.a.createElement(o.a.Fragment,null,o.a.createElement(c.Button,{className:v.a.button,appearance:"primary",onClick:ge},O(["banner","upgrade"])),o.a.createElement("button",{className:v.a.closeButton,onClick:fe},o.a.createElement(m.default,{className:v.a.closeIcon,name:m.IconName.Close,medium:!0}))))),M&&o.a.createElement(y.PlanSelectionOverlay,{orgId:N,onContinue:function(){},onClose:function(){return S(!1)},trialLength:X.count}))}},"./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./app/src/components/FreeTrial/FreeTrialBanner.less":function(e,n,a){(n=e.exports=a("./node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,"._3QfNAnBeb5MXCS{padding:0 4px 0 16px;height:40px;background-color:rgba(9,30,66,.95);display:flex;align-items:center;justify-content:space-between;line-height:18px;font-weight:600}._5PgQi1bn-4l3qI{margin-right:8px}._1_uAu9Z6xjwuz9{color:#fff;background-color:rgba(9,30,66,.95)}._1qjssZ1iwLuaP5{color:#172b4d;background-color:#d6ecd2}._1ta38j4GmHUsTw{display:flex;flex-direction:row;align-items:center}.WMV_Nnak6jlW5q{display:flex;justify-content:center;align-items:center;background-color:#42526e;border-radius:3px;width:24px;height:24px;margin:0 4px}._8xBegbhXb5B02c{display:flex;flex-direction:row}._8xBegbhXb5B02c a{display:flex;align-items:center;margin-right:8px;-webkit-text-decoration-line:underline;text-decoration-line:underline;font-size:12px;line-height:16px;font-weight:500;cursor:pointer}._1XazycWMJxPXZ7{color:#a5adba}._1XazycWMJxPXZ7:hover{color:#fff}._2T9VGoSVwTCClN{color:#172b4d}._3Ma7XvbkR__6ZG{margin:0}._1v8GVHyNTRAG1m{margin:0;padding:0}._1v8GVHyNTRAG1m,._1v8GVHyNTRAG1m:hover{background-color:transparent}._1a2N7Y8vuH0tha{margin-left:2px;color:#42526e}._1a2N7Y8vuH0tha:hover{color:#fff}._1SLq6R5EvPUlFj{margin-left:2px;color:#6b778c}._1SLq6R5EvPUlFj:hover{color:#42526e}",""]),n.locals={container:"_3QfNAnBeb5MXCS",emoji:"_5PgQi1bn-4l3qI",bannerBg:"_1_uAu9Z6xjwuz9",expiredBg:"_1qjssZ1iwLuaP5",bcContainer:"_1ta38j4GmHUsTw",daysContainer:"WMV_Nnak6jlW5q",ctaContainer:"_8xBegbhXb5B02c",learnMoreCta:"_1XazycWMJxPXZ7",sendFeedbackCta:"_2T9VGoSVwTCClN",button:"_3Ma7XvbkR__6ZG",closeButton:"_1v8GVHyNTRAG1m",closeIcon:"_1a2N7Y8vuH0tha",expiredCloseIcon:"_1SLq6R5EvPUlFj"}}}]);
//# sourceMappingURL=free-trial-banner.feb392ecfc06350e46f2.js.map