(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"./app/src/components/EmailHygieneWizard/Analytics.ts":function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return o}));var a=t("./packages/analytics/index.ts"),r=t("./packages/atlassian-analytics/index.ts"),i=function(e){var n=e.verb,t=e.noun,i=e.method,o=e.context,c=e.actionSubject,s=e.actionSubjectId,l=e.action,u=e.source;Object(a.trackUe)({category:a.Noun.EMAIL_HYGIENE,verb:n,directObj:t,method:i,context:JSON.stringify(o)}),r.Analytics.sendUIEvent({action:l,actionSubject:c,actionSubjectId:s,source:u,attributes:o})},o=function(e,n){Object(a.trackUe)({category:a.Noun.EMAIL_HYGIENE,verb:a.Verb.VIEWS,directObj:e,context:JSON.stringify(n)}),r.Analytics.sendScreenEvent({name:e,attributes:n})}},"./app/src/components/EmailHygieneWizard/EmailHygieneBanner.less":function(e,n,t){var a=t("./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./app/src/components/EmailHygieneWizard/EmailHygieneBanner.less");"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};t("./node_modules/style-loader/lib/addStyles.js")(a,r);a.locals&&(e.exports=a.locals)},"./app/src/components/EmailHygieneWizard/getCanCompleteEmailHygiene.ts":function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return i})),t.d(n,"c",(function(){return o}));var a=t("./packages/dates/index.ts"),r="primary-email-hygiene",i="peh-change-email";function o(e){var n,t,o=!!(null===(n=e.oneTimeMessagesDismissed)||void 0===n?void 0:n.includes(r)),c=!!(null===(t=e.oneTimeMessagesDismissed)||void 0===t?void 0:t.includes(i)),s=e.logins.sort((function(e,n){return e.id.localeCompare(n.id)}))[0],l=s&&(Date.now()-Object(a.c)(s.id).valueOf())/1e3/60/60/24;return!(!e.confirmed||e.idEnterprise||!(!l||l>7||c)||e.isAaMastered||e.aaEnrolledDate||o)}},"./app/src/components/EmailHygieneWizard/index.ts":function(e,n,t){"use strict";t.r(n),t.d(n,"EmailHygieneBanner",(function(){return x})),t.d(n,"getCanCompleteEmailHygiene",(function(){return y.c})),t.d(n,"HYGIENE_MESSAGE_ID",(function(){return y.b})),t.d(n,"CHANGE_EMAIL_MESSAGE_ID",(function(){return y.a}));var a=t("./node_modules/react/index.js"),r=t.n(a),i=t("./packages/analytics/index.ts"),o=t("./packages/atlassian-analytics/index.ts"),c=t("./packages/colors/index.ts"),s=t("./packages/feature-flag-client/index.ts"),l=t("./packages/graphql/generated.tsx"),u=t("./app/common/components/banner/banner.tsx"),d=t("./app/common/lib/util/i18n/index.ts"),m=t("./app/src/components/Overlay/index.ts"),f=t("./app/src/components/EmailHygieneWizard/Analytics.ts"),p=t("./app/src/components/EmailHygieneWizard/EmailHygieneBanner.less"),b=t.n(p),y=t("./app/src/components/EmailHygieneWizard/getCanCompleteEmailHygiene.ts"),g=t("./app/src/components/EmailHygieneWizard/useSnooze.ts");function v(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],a=!0,r=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(t.push(o.value),!n||t.length!==n);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}return t}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return E(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return E(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var S,j=t.e(26).then(t.bind(null,"./app/src/components/EmailHygieneWizard/EmailHygieneWizard.tsx")),h=Object(a.lazy)((function(){return j})),I=Object(d.forNamespace)(["email hygiene wizard","banner"],{shouldEscapeStrings:!1}),x=function(e){var n,t,d=e.forceShow,p=v(Object(a.useState)(!1),2),E=p[0],j=p[1],x=v(Object(a.useState)(!1),2),k=x[0],A=x[1],O=Object(s.useFeatureFlag)("aa4a.show-email-hygiene",!1),H=Object(s.useFeatureFlag)("aa4a.peh-snooze-time",0),_=Object(g.a)("peh-snooze",H),w=_.isSnoozed,z=_.snooze,C=Object(l.lb)({variables:{memberId:"me"}}),N=C.data&&C.data.member;Object(a.useEffect)((function(){if(null==N?void 0:N.logins){var e,n=Object(y.c)(N),t=!!(null===(e=N.oneTimeMessagesDismissed)||void 0===e?void 0:e.includes(y.a)),a=d||/[?&]forceHygiene=true/i.test(window.location.search);w?(A(!1),j(!1)):a?(j(!0),A(!0)):n?(t||O)&&(j(!0),A(!0)):j(!1)}}),[N,d,O,w]);var D=Object(a.useCallback)((function(){C.refetch(),A(!0),Object(f.a)({verb:i.Verb.INITIATES,noun:i.Noun.EMAIL_HYGIENE_WIZARD,method:"by clicking banner link",context:S,source:o.Source.emailHygieneBanner,action:o.Action.clicked,actionSubject:o.ActionSubject.link,actionSubjectId:o.ActionSubjectId.emailHygieneBannerLink})}),[C]),L=Object(a.useCallback)((function(){z(),Object(f.a)({verb:i.Verb.DISMISSES,noun:i.Noun.EMAIL_HYGIENE_WIZARD,method:"by clicking remind me later link",context:S,source:o.Source.emailHygieneBanner,action:o.Action.clicked,actionSubject:o.ActionSubject.link,actionSubjectId:o.ActionSubjectId.emailHygieneBannerDismissLink})}),[z]),M=N&&Array.from(N.logins);return M&&M.sort((function(e,n){return(n.primary?1:0)-(e.primary?1:0)||n.id.localeCompare(e.id)})),!S&&N&&(S={organizationId:N.idEnterprise,totalEmailAddresses:null==M?void 0:M.length,totalClaimableEmailAddresses:null==M?void 0:M.filter((function(e){return e.claimable})).length}),Object(a.useEffect)((function(){E&&Object(f.b)(o.Source.emailHygieneBanner,S)}),[E]),N&&M?r.a.createElement("div",null,E&&r.a.createElement(u.a,{className:b.a.banner,bannerColor:c.N800},r.a.createElement("p",{className:b.a.text},r.a.createElement("span",{role:"img","aria-label":""},"ðŸ‘‹"),I("main-message",{name:N.fullName}),r.a.createElement("a",{href:"#",className:b.a.updateLink,onClick:function(e){e.preventDefault(),D()}},I("link-text")),H>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:b.a.linkSeparator},"Â·"),r.a.createElement("a",{href:"#",className:b.a.dismissLink,onClick:function(e){e.preventDefault(),L()}},I("snooze-link-text"))))),k&&r.a.createElement(m.a,{background:m.c.LIGHT,closeOnEscape:!1,onClose:function(){},alignment:m.b.TOP},r.a.createElement(a.Suspense,{fallback:null},r.a.createElement(h,{logins:M,name:N.fullName||N.username,hasTwoFactor:!!(null===(n=N.prefs)||void 0===n||null===(t=n.twoFactor)||void 0===t?void 0:t.enabled),avatarUrl:N.avatarUrl||void 0,initials:N.initials||void 0,onDismiss:function(){return A(!1)},onSnooze:H?z:void 0,analyticsContext:S,onComplete:function(){j(!1),A(!1)}})))):null}},"./app/src/components/EmailHygieneWizard/useSnooze.ts":function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t("./node_modules/react/index.js");function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],a=!0,r=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(t.push(o.value),!n||t.length!==n);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}return t}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return i(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return i(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function o(e,n){var t=r(Object(a.useState)(!1),2),i=t[0],o=t[1],c=Object(a.useCallback)((function(){var t=!1,a=localStorage.getItem(e);if(a){var r=1e3*n,i=parseInt(a);r&&i&&i+r>Date.now()?(t=!0,setTimeout((function(){c()}),r+1e3)):localStorage.removeItem(e)}o(t)}),[e,n]);return Object(a.useEffect)((function(){c()}),[c]),{isSnoozed:i,snooze:Object(a.useCallback)((function(){n>0&&(localStorage.setItem(e,Date.now().toString()),c())}),[e,n,c])}}},"./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/less-loader/dist/cjs.js?!./app/src/components/EmailHygieneWizard/EmailHygieneBanner.less":function(e,n,t){(n=e.exports=t("./node_modules/css-loader/lib/css-base.js")(!1)).push([e.i,"._3_IIx3qL7PLWV0{padding:0;text-align:center;background-color:#172b4d}.y713MCtKnRL7Xv{color:#dfe1e6;line-height:32px;margin:0}.y713MCtKnRL7Xv ._3DtarySw4qn2vr,.y713MCtKnRL7Xv a{color:#97a0af;margin-left:8px}",""]),n.locals={banner:"_3_IIx3qL7PLWV0",text:"y713MCtKnRL7Xv",linkSeparator:"_3DtarySw4qn2vr"}}}]);
//# sourceMappingURL=email-hygiene-banner.f270db599225ce8873d6.js.map